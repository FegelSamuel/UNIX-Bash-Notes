This is copy-pasted from Mohammed Amine Belkoura. I haven't touched any of this code.
